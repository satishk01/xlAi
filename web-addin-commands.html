<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <title>Excel-Ollama AI Plugin Commands</title>
    
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .hidden {
            display: none;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>

<body>
    <div id="status" class="status info">
        Excel-Ollama AI Plugin Commands Ready
    </div>
    
    <div id="loading" class="loading hidden">
        <div class="spinner"></div>
        <p>Processing...</p>
    </div>
    
    <script src="web-based-excel-addin.js"></script>
    
    <script>
        // Additional command-specific functions
        
        function updateStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
        }
        
        function showLoading(show = true) {
            const loadingDiv = document.getElementById('loading');
            if (show) {
                loadingDiv.classList.remove('hidden');
            } else {
                loadingDiv.classList.add('hidden');
            }
        }
        
        // Override the progress functions to use our UI
        window.showProgress = function(message) {
            updateStatus(message, 'info');
            showLoading(true);
        };
        
        window.hideProgress = function() {
            showLoading(false);
            updateStatus('Ready', 'success');
        };
        
        window.showError = function(message) {
            showLoading(false);
            updateStatus('Error: ' + message, 'error');
            console.error(message);
        };
        
        window.showMessage = function(message) {
            showLoading(false);
            updateStatus(message, 'success');
        };
        
        // Initialize when Office is ready
        Office.onReady(() => {
            updateStatus('Excel-Ollama AI Plugin loaded successfully!', 'success');
            console.log('Commands page loaded');
        });
    </script>
</body>
</html>